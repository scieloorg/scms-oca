{% extends "base.html" %}
{% load humanize %}
{% load static %}
{% load i18n %}
{% load wagtailsettings_tags %}
{% load sizify %}
{% load partition %}
{% load humanize %}
{% load translate %}

{% get_settings use_default_site=True %}


{% block content %}
<section id="content" class="mt-3">
  <div class="container">
    <div class="row">
      <div class="col pl-0 pr-0">

        <div class="card mb-2 p-3" style="background:#F9F9F9;">
          <div class="page-title-content">
            <h1 class="mb-1">Indicators</h1>
            <span>Data panel of the OCABr Observatory</span>
          </div>
        </div>

      </div>
    </div>

    <div class="row card mb-2 p-3" style="background:#F9F9F9;">
      {% if data_source == "scielo" %}
        <h4 class="my-0">Scientific Production - SciELO Network</h4>
      {% elif data_source == "openalex_works" and country_unit == "BR" %}
        <h4 class="my-0">Scientific Production - Brazil</h4>
      {% elif data_source == "openalex_works" %}
        <h4 class="my-0">Scientific Production - World</h4>
      {% elif data_source == "social_production" %}
        <h4 class="my-0">Social Production</h4>
      {% endif %}
    </div>

    <div class="row mb-3" id="mainContent">
      <!-- Loading Overlay -->
      <div id="optionsLoading" style="display:none; position:absolute; width:100%; height:100%; background:rgba(255,255,255,0.8); z-index:10; justify-content:center; align-items:flex-start; text-align:center; margin-top: 1em;">
        <div class="spinner-border text-primary" role="status" style="width:3rem; height:3rem;">
          <span class="sr-only">Loading...</span>
        </div>
      </div>

      <!-- Menu -->
      <div class="col-lg-3 card mb-2 pt-2">
        <!-- Graph Options -->
        <div id="graph-options-container">
          {% include "graph_options_menu.html" %}
        </div>

        <!-- Filters -->
        <div id="filters-container">
          {% include "filters_menu.html" %}
        </div>
      </div>

      <!-- Graphs -->
      <div class="col-lg-9 mx-0 px-0">
        <!-- Applied Filters -->
        <div class="card mb-2 ml-2 p-3 d-none" id="applied-filters"></div>

        <!-- Main Graph -->
        <div class="card mb-2 ml-2 p-3 d-none" id="main-chart-div" style="height:75vh;">
          <div class="mx-auto" style="width:100%; height:100%;">
            <div id="main-chart" style="width:100%; height:100%;"></div>
          </div>
        </div>

        <!-- Inner Percentage Graph -->
        <div class="card mb-2 ml-2 p-3 d-none" id="inner-percentage-chart-div" style="height:75vh;">
          <div class="mx-auto" style="width:100%; height:100%;">
            <div id="inner-percentage-chart" style="width:100%; height:100%;"></div>
          </div>
        </div>

        <!-- Outer Percentage Graph -->
        <div class="card mb-2 ml-2 p-3 d-none" id="outer-percentage-chart-div" style="height:75vh;">
          <div class="mx-auto" style="width:100%; height:100%;">
            <div id="outer-percentage-chart" style="width:100%; height:100%;"></div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>
{% endblock %}

{% block inline_javascript %}
  <link href="{% static 'css/select2.min.css' %}" rel="stylesheet" />
  <script src="{% static 'js/plugins/select2.min.js' %}"></script>
  <script src="{% static 'js/echarts/echarts.min.js' %}"></script>
  <script>
    window.data_source = "{{ data_source }}";
    window.country_unit = "{{ country_unit }}";
  </script>
  <script src="{% static 'js/indicators/helpers.js' %}"></script>
  <script src="{% static 'js/indicators/applied_filters.js' %}"></script>
  <script src="{% static 'js/indicators/charts.js' %}"></script>
  <script src="{% static 'js/indicators/filters.js' %}"></script>
{% endblock %}
